<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>배송 정보 입력</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container py-4">
      <h2 class="text-center mb-4">배송 정보 입력</h2>
      <form id="orderForm" class="bg-white p-4 rounded shadow-sm">
        <input
          type="text"
          class="form-control mb-3"
          id="name"
          placeholder="고객명"
          required
        />
        <input
          type="tel"
          class="form-control mb-3"
          id="phone"
          placeholder="연락처"
          required
        />
        <input
          type="text"
          class="form-control mb-3"
          id="roadAddress"
          placeholder="도로명 주소"
          readonly
          onclick="execDaumPostcode()"
          required
        />
        <input
          type="text"
          class="form-control mb-3"
          id="detailAddress"
          placeholder="상세 주소"
          required
        />
        <button type="submit" class="btn btn-primary w-100">제출</button>
        <div
          id="msg"
          class="text-success text-center mt-3"
          style="display: none"
        >
          제출 완료!
        </div>
      </form>
    </div>

    <script>
      function execDaumPostcode() {
        new daum.Postcode({
          oncomplete: function (data) {
            document.getElementById("roadAddress").value = data.roadAddress;
            document.getElementById("detailAddress").focus();
          },
        }).open();
      }

      document
        .getElementById("orderForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const data = {
            name: document.getElementById("name").value.trim(),
            phone: document.getElementById("phone").value.trim(),
            roadAddress: document.getElementById("roadAddress").value.trim(),
            detailAddress: document
              .getElementById("detailAddress")
              .value.trim(),
          };

          fetch("https://script.google.com/macros/s/AKfycbzQx5SVy0uKgc_FbXqTK9fkbbeYLribuieWxeShTqtPKLlS8OjiD3Yahm1rfjTjcnTz/exec", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams(data),
          })
            .then((res) => res.text())
            .then(() => {
              document.getElementById("msg").style.display = "block";
              document.getElementById("orderForm").reset();
              document.getElementById("roadAddress").value = "";
            })
            .catch((err) => alert("전송 실패: " + err));
        });
    </script>
  </body>
</html>
